<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zyra Blockchain Explorer</title>
  <meta name="description" content="Zyra: The most advanced blockchain explorer with real-time search, analytics, and multi-chain support." />
  <link rel="icon" href="zyra-logo.svg" />
  <style>
    body {
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #0047ab 0%, #001f4d 100%);
      color: #d0e8ff;
      margin: 0;
      min-height: 100vh;
      transition: background 0.5s;
    }
    header {
      padding: 1rem 3rem;
      background: rgba(0, 71, 171, 0.9);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      box-shadow: 0 4px 16px #3385ff44;
      border-bottom: 2px solid #3385ff44;
    }
    .logo {
      font-weight: 700;
      font-size: 1.6rem;
      color: #a8d0ff;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 0.7rem;
      animation: logoPulse 2s infinite alternate;
    }
    @keyframes logoPulse {
      from { filter: drop-shadow(0 0 0 #7eff7e); }
      to { filter: drop-shadow(0 0 12px #7eff7e); }
    }
    nav {
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }
    nav a {
      font-weight: 600;
      font-size: 1rem;
      color: #a8d0ff;
      text-decoration: none;
      padding: 0.3rem 0.5rem;
      border-radius: 4px;
      transition: background-color 0.3s, color 0.3s, box-shadow 0.3s;
      box-shadow: 0 2px 8px #3385ff22;
    }
    nav a:hover, nav a:focus {
      background-color: #3385ffcc;
      color: #001f4d;
      outline: 2px solid #66b2ff;
      outline-offset: 2px;
      box-shadow: 0 4px 16px #7eff7e44;
      transform: scale(1.08);
    }
    .nav-btn {
      background: linear-gradient(90deg,#3385ff,#7eff7e);
      color: #001f4d;
      border: none;
      border-radius: 8px;
      padding: 0.45rem 1.1rem;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      min-width: 120px;
      box-shadow: 0 2px 8px #3385ff44;
      transition: background 0.3s, color 0.3s, transform 0.2s;
      margin-bottom: 0.5rem;
      margin-right: 0.5rem;
    }
    .nav-btn:hover {
      background: linear-gradient(90deg,#7eff7e,#3385ff);
      color: #181f2a;
      transform: scale(1.06);
    }
    main {
      max-width: 1000px;
      margin: 2rem auto;
      background: rgba(30, 60, 130, 0.7);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 0 20px #3399ffbb;
      animation: fadeIn 1s;
    }
    h1 {
      color: #a8d0ff;
      font-size: 2.4rem;
      margin-bottom: 1.5rem;
      text-align: center;
      font-weight: 700;
      letter-spacing: 0.1em;
      background: linear-gradient(90deg,#3385ff,#7eff7e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: fadeIn 1s;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .search-bar {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    .search-bar input {
      padding: 0.7rem 1.2rem;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
      width: 320px;
      background: #e0f0ff;
      color: #0047ab;
      transition: box-shadow 0.2s;
      box-shadow: 0 2px 8px #3385ff22;
    }
    .search-bar input:focus {
      box-shadow: 0 0 0 2px #3385ff;
      outline: none;
    }
    .search-bar button {
      background: #1e3c82;
      color: #a8d0ff;
      border: 1.5px solid #3385ff;
      border-radius: 8px;
      padding: 0.7rem 1.5rem;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
      box-shadow: 0 2px 8px #3385ff22;
    }
    .search-bar button:hover, .search-bar button:focus {
      background-color: #3385ff;
      color: #001f4d;
      outline: 2px solid #66b2ff;
      outline-offset: 2px;
    }
    .results {
      margin-top: 2rem;
    }
    .result-card {
      background: rgba(50, 100, 255, 0.15);
      border-radius: 10px;
      padding: 1.2rem 1.5rem;
      margin-bottom: 1.2rem;
      box-shadow: 0 2px 8px #3385ff44;
      color: #cce4ff;
      animation: fadeIn 0.7s;
      transition: box-shadow 0.3s;
    }
    .result-card:hover {
      box-shadow: 0 4px 16px #7eff7e44;
      border: 1px solid #7eff7e;
    }
    .result-title {
      font-weight: 700;
      color: #66b2ff;
      margin-bottom: 0.5rem;
      font-size: 1.15rem;
    }
    .result-details {
      font-size: 1rem;
      color: #e0f0ff;
      word-break: break-word;
    }
    .result-details a {
      color: #99c9ff;
      text-decoration: underline;
    }
    .result-details .status-confirmed {
      color: #7eff7e;
      font-weight: 600;
    }
    .result-details .status-pending {
      color: #ffb366;
      font-weight: 600;
    }
    .analytics-section {
      margin-top: 2.5rem;
      background: rgba(30, 60, 130, 0.7);
      border-radius: 15px;
      padding: 1.5rem;
      box-shadow: 0 0 12px #3399ff99;
      color: #d0e8ff;
      animation: fadeIn 1.3s;
    }
    .multi-chain-bar {
      margin-top: 2rem;
      display: flex;
      gap: 2rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    .chain-card {
      background: rgba(50, 100, 255, 0.15);
      border-radius: 10px;
      padding: 1rem 1.5rem;
      color: #cce4ff;
      min-width: 180px;
      text-align: center;
      box-shadow: 0 2px 8px #3385ff44;
      font-weight: 600;
      transition: box-shadow 0.3s;
    }
    .chain-card:hover {
      box-shadow: 0 4px 16px #7eff7e44;
      border: 1px solid #7eff7e;
    }
    .chain-card .chain-title {
      color: #66b2ff;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }
    .chain-card .chain-address {
      font-size: 0.95rem;
      color: #e0f0ff;
      word-break: break-all;
    }
    .chain-card .chain-balance {
      font-size: 1.05rem;
      color: #7eff7e;
      margin-top: 0.5rem;
    }
    .chain-card button {
      margin-top: 0.7rem;
      background: #3385ff;
      color: #001f4d;
      border: none;
      border-radius: 6px;
      padding: 0.5rem 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }
    .chain-card button:hover {
      background: #66b2ff;
    }
    .nft-gallery {
      margin-top:2rem;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      gap:1.2rem;
    }
    .nft-gallery-card {
      background:#1e293b;
      border-radius:12px;
      padding:1rem;
      text-align:center;
      color:#d0e8ff;
      box-shadow:0 2px 8px #3385ff44;
      transition: box-shadow 0.3s;
      animation: fadeIn 1.2s;
    }
    .nft-gallery-card:hover {
      box-shadow: 0 4px 16px #7eff7e44;
      border: 1px solid #7eff7e;
    }
    .nft-gallery-card img {
      width:100%;
      height:120px;
      object-fit:cover;
      border-radius:8px;
      margin-bottom:0.7rem;
      transition: transform 0.3s;
    }
    .nft-gallery-card img:hover {
      transform: scale(1.08);
    }
    .nft-gallery-card .nft-name {
      font-weight:700;
      color:#66b2ff;
    }
    .nft-gallery-card .nft-owner {
      font-size:0.85rem;
      color:#7eff7e;
      margin-top:0.5rem;
    }
    .governance-section {
      margin-top:2rem;
    }
    .governance-card {
      background:#1e293b;
      border-radius:10px;
      padding:1rem;
      margin-bottom:1rem;
      color:#d0e8ff;
      box-shadow:0 2px 8px #3385ff44;
      transition: box-shadow 0.3s;
      animation: fadeIn 1.2s;
    }
    .governance-card:hover {
      box-shadow: 0 4px 16px #7eff7e44;
      border: 1px solid #7eff7e;
    }
    .governance-card .gov-title {
      font-weight:700;
      color:#66b2ff;
    }
    .governance-card .gov-desc {
      font-size:0.95rem;
    }
    .governance-card .gov-votes {
      margin-top:0.5rem;
      font-size:0.85rem;
      color:#7eff7e;
    }
    .governance-card .gov-actions button {
      margin-right:1rem;
      background: linear-gradient(90deg,#3385ff,#7eff7e);
      color: #001f4d;
      border: none;
      border-radius: 8px;
      padding: 0.45rem 1.1rem;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      min-width: 90px;
      box-shadow: 0 2px 8px #3385ff44;
      transition: background 0.3s, color 0.3s, transform 0.2s;
    }
    .governance-card .gov-actions button:hover {
      background: linear-gradient(90deg,#7eff7e,#3385ff);
      color: #181f2a;
      transform: scale(1.06);
    }
    .explorer-switch-bar {
      margin:2rem 0;
      text-align:center;
    }
    .explorer-switch-bar button {
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      padding: 0.5rem 1.2rem;
      margin-right: 0.5rem;
      cursor: pointer;
      box-shadow: 0 2px 8px #3385ff44;
      transition: background 0.3s, color 0.3s, transform 0.2s;
    }
    .explorer-switch-bar button:hover {
      transform: scale(1.08);
      filter: brightness(1.2);
    }
    footer {
      text-align: center;
      padding: 1rem 0;
      font-weight: 500;
      font-size: 0.9rem;
      color: #a0c4ffbb;
      background: rgba(0, 31, 77, 0.8);
      letter-spacing: 0.08em;
      margin-top: 2rem;
    }
    .network-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .stat-card {
      background: rgba(30, 60, 130, 0.7);
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 4px 16px rgba(51, 133, 255, 0.2);
      transition: transform 0.3s;
      border: 1px solid rgba(51, 133, 255, 0.3);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      border-color: #7eff7e;
    }

    .stat-title {
      color: #a8d0ff;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: #7eff7e;
      margin-bottom: 1rem;
      background: linear-gradient(90deg, #3385ff, #7eff7e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .stat-chart {
      height: 60px;
      margin-top: 1rem;
    }

    .stat-progress {
      background: rgba(51, 133, 255, 0.2);
      height: 8px;
      border-radius: 4px;
      margin-top: 1rem;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #3385ff, #7eff7e);
      width: 0%;
      transition: width 0.3s ease;
    }
    @media (max-width: 650px) {
      header {
        flex-direction: column;
        gap: 1rem;
        padding: 1rem 1.5rem;
      }
      main {
        padding: 2rem 1rem;
      }
      .search-bar input {
        width: 100%;
      }
      .multi-chain-bar {
        flex-direction: column;
        gap: 1rem;
      }
    }

    /* New styles for explorer layout */
    .explorer-layout {
      display: grid;
      grid-template-columns: 200px 1fr;
      gap: 2rem;
      margin: 2rem 0;
    }

    .explorer-switch-panel {
      position: sticky;
      top: 2rem;
      background: rgba(30, 60, 130, 0.7);
      border-radius: 12px;
      padding: 1.5rem;
      height: fit-content;
      border: 1px solid rgba(51, 133, 255, 0.3);
    }

    .explorer-switch-panel h3 {
      color: #a8d0ff;
      margin-bottom: 1.5rem;
      font-size: 1.1rem;
      text-align: center;
      background: linear-gradient(90deg, #3385ff, #7eff7e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .explorer-switch-panel button {
      width: 100%;
      padding: 0.8rem;
      margin-bottom: 0.8rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s;
    }

    .explorer-switch-panel button:hover {
      transform: translateX(5px);
      box-shadow: 0 4px 12px rgba(51, 133, 255, 0.4);
    }

    .explorer-switch-panel button img {
      width: 20px;
      height: 20px;
    }

    .explorer-main-content {
      flex: 1;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .explorer-layout {
        grid-template-columns: 1fr;
      }

      .explorer-switch-panel {
        position: relative;
        top: 0;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 0.8rem;
      }

      .explorer-switch-panel button {
        margin-bottom: 0;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <div class="logo">
      <svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="19" cy="19" r="18" stroke="#3385ff" stroke-width="2" fill="#0047ab"/>
        <path d="M19 8L25 19H13L19 8Z" fill="#a8d0ff"/>
        <circle cx="19" cy="25" r="4" fill="#66b2ff"/>
      </svg>
      ZYRA
    </div>
    <!-- Update the navigation section -->
    <nav aria-label="Main Navigation">
      <button class="nav-btn" onclick="window.location.href='index.html'">Dashboard</button>
      <button class="nav-btn" onclick="window.location.href='explorer.html'">Explorer</button>
      <button class="nav-btn" onclick="window.location.href='validators.html'">Validators</button>
      <button class="nav-btn" onclick="window.location.href='governance.html'">Governance</button>
      <button class="nav-btn" onclick="window.location.href='launchpad.html'">Launchpad</button>
      <button class="nav-btn" onclick="window.location.href='nfts.html'">NFTs</button>
      <button class="nav-btn" onclick="window.location.href='docs.html'">Docs</button>
      <button class="nav-btn" onclick="window.location.href='exchange.html'">Exchange</button>
    </nav>
  </header>
  <main>
    <h1>Zyra Blockchain Explorer</h1>
    <div id="livePrices" style="text-align:center;margin-bottom:2rem;font-size:1.15rem;"></div>
    <div class="search-bar">
      <input type="text" id="explorerSearch" placeholder="Search block, transaction, address, NFT, or validator..." aria-label="Search" autocomplete="off" />
      <button id="searchBtn" aria-label="Search">Search</button>
      <button id="advancedSearchBtn" aria-label="Advanced Search">⚙️</button>
    </div>
    <div id="advancedSearchPanel" style="display:none;margin-bottom:1rem;">
      <label>
        <input type="checkbox" id="searchNFTs" /> NFTs
      </label>
      <label>
        <input type="checkbox" id="searchValidators" /> Validators
      </label>
      <label>
        <input type="checkbox" id="searchTokens" /> Tokens
      </label>
      <label>
        <input type="checkbox" id="searchContracts" /> Smart Contracts
      </label>
    </div>
    <!-- Replace the existing multiChainBar section with network stats -->
    <div class="network-stats">
      <div class="stat-card">
          <div class="stat-title">TPS</div>
          <div class="stat-value" id="tpsValue">0</div>
          <div class="stat-chart">
              <canvas id="tpsChart"></canvas>
          </div>
      </div>
      <div class="stat-card">
          <div class="stat-title">Active Nodes</div>
          <div class="stat-value" id="nodesValue">0</div>
          <div class="stat-chart">
              <canvas id="nodesChart"></canvas>
          </div>
      </div>
      <div class="stat-card">
          <div class="stat-title">Block Time</div>
          <div class="stat-value" id="blockTimeValue">0s</div>
          <div class="stat-chart">
              <canvas id="blockTimeChart"></canvas>
          </div>
      </div>
      <div class="stat-card">
          <div class="stat-title">Network Load</div>
          <div class="stat-value" id="networkLoadValue">0%</div>
          <div class="stat-progress">
              <div id="networkLoadBar" class="progress-bar"></div>
          </div>
      </div>
    </div>
    <div class="results" id="results"></div>
    <div class="analytics-section">
      <h2 style="text-align:center;color:#a8d0ff;">Live Analytics</h2>
      <canvas id="analyticsChart" height="120"></canvas>
      <div id="nodeCount" style="text-align:center;margin-top:1rem;font-size:1.1rem;color:#7eff7e;"></div>
    </div>
    <div class="nft-gallery" id="nftGallery"></div>
    <div class="governance-section" id="governancePanel"></div>
    <!-- Replace the explorer-layout section with this -->
    <div class="explorer-layout">
      <!-- Left side explorer switch panel -->
      <div class="explorer-switch-panel">
          <h3>Other Explorers</h3>
          <button class="nav-btn explorer-btn" onclick="window.open('https://www.blockchain.com/explorer', '_blank')">
              Bitcoin Explorer
          </button>
          <button class="nav-btn explorer-btn" onclick="window.open('https://explorer.solana.com/', '_blank')">
              Solana Explorer
          </button>
          <button class="nav-btn explorer-btn" onclick="window.open('https://xrpscan.com/', '_blank')">
              XRP Explorer
          </button>
          <button class="nav-btn explorer-btn" onclick="window.open('https://etherscan.io/', '_blank')">
              Ethereum Explorer
          </button>
          <button class="nav-btn explorer-btn" onclick="window.open('https://explorer.kaspa.org/', '_blank')">
              Kaspa Explorer
          </button>
          <button class="nav-btn explorer-btn" onclick="window.open('https://zyra.network/explorer', '_blank')">
              ZYRA Explorer
          </button>
      </div>

      <!-- Main content - Remove duplicate buttons -->
      <div class="explorer-main-content">
          <!-- Add live transaction feed -->
          <div class="live-transactions">
            <h2>Live Transactions</h2>
            <div class="transaction-feed" id="transactionFeed"></div>
          </div>
      </div>
    </div>
  </main>
  <footer>
    © 2025 Zyra Blockchain. All rights reserved.
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    // --- Multi-chain wallet integration (Ethereum & Solana) ---
    const multiChainBar = document.getElementById('multiChainBar');
    let ethWallet = { address: null, balance: null };
    let solWallet = { address: null, balance: null };

    function renderMultiChainWallet(eth, sol) {
      multiChainBar.innerHTML = `
        <div class="chain-card">
          <div class="chain-title">Ethereum (MetaMask)</div>
          <div class="chain-address">${eth.address ? eth.address : 'Not connected'}</div>
          <div class="chain-balance">${eth.balance ? eth.balance : '-- ETH'}</div>
          <button onclick="connectEthWallet()">Connect MetaMask</button>
        </div>
        <div class="chain-card">
          <div class="chain-title">Solana (Phantom)</div>
          <div class="chain-address">${sol.address ? sol.address : 'Not connected'}</div>
          <div class="chain-balance">${sol.balance ? sol.balance : '-- SOL'}</div>
          <button onclick="connectSolWallet()">Connect Phantom</button>
        </div>
      `;
    }

    window.connectEthWallet = async function() {
      if (window.ethereum) {
        try {
          const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
          const provider = new ethers.providers.Web3Provider(window.ethereum);
          const balance = await provider.getBalance(accounts[0]);
          ethWallet = {
            address: accounts[0],
            balance: ethers.utils.formatEther(balance) + " ETH"
          };
          renderMultiChainWallet(ethWallet, solWallet);
        } catch (err) {
          alert("MetaMask connection failed: " + err.message);
        }
      } else {
        alert("MetaMask not detected. Please install MetaMask extension.");
      }
    };

    window.connectSolWallet = async function() {
      if (window.solana && window.solana.isPhantom) {
        try {
          const resp = await window.solana.connect();
          // Get balance from Solana RPC
          fetch("https://api.mainnet-beta.solana.com", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              jsonrpc: "2.0",
              id: 1,
              method: "getBalance",
              params: [resp.publicKey.toString()]
            })
          })
          .then(res => res.json())
          .then(data => {
            solWallet = {
              address: resp.publicKey.toString(),
              balance: (data.result.value / 1e9).toFixed(4) + " SOL"
            };
            renderMultiChainWallet(ethWallet, solWallet);
          });
        } catch (err) {
          alert("Phantom connection failed: " + err.message);
        }
      } else {
        alert("Phantom wallet not detected. Please install Phantom extension.");
      }
    };

    renderMultiChainWallet(ethWallet, solWallet);

    // --- Real-time analytics chart ---
    const analyticsCtx = document.getElementById('analyticsChart').getContext('2d');
    const analyticsChart = new Chart(analyticsCtx, {
      type: 'bar',
      data: {
        labels: ['TPS', 'Nodes', 'Latency', 'Finality'],
        datasets: [{
          label: 'Live Metrics',
          data: [0,0,0,0],
          backgroundColor: ['#66b2ff','#a8d0ff','#ffb366','#7eff7e']
        }]
      },
      options: {
        scales: { y: { beginAtZero: true } },
        plugins: { legend: { display: false } }
      }
    });
    // Update analytics chart via WebSocket
    const analyticsWs = new WebSocket("wss://api.zyra.network/analytics");
    const nodeCountDiv = document.getElementById('nodeCount');
    analyticsWs.onmessage = function(event) {
      try {
        const data = JSON.parse(event.data);
        analyticsChart.data.datasets[0].data = [
          data.tps, data.nodes, data.latency, data.finality
        ];
        analyticsChart.update();
        nodeCountDiv.textContent = `Active Nodes: ${data.nodes}`;
      } catch(e) {}
    };

    // --- Real-time NFT Gallery ---
    const nftGallery = document.getElementById('nftGallery');
    const nftWs = new WebSocket("wss://api.zyra.network/nft-stream");
    nftWs.onmessage = function(event) {
      try {
        const nfts = JSON.parse(event.data);
        nftGallery.innerHTML = '';
        nfts.forEach(nft => {
          const card = document.createElement('div');
          card.className = "nft-gallery-card";
          card.innerHTML = `
            <img src="${nft.image}" alt="${nft.name}">
            <div class="nft-name">${nft.name}</div>
            <div class="nft-owner">Owner: ${nft.owner.slice(0,8)}...</div>
          `;
          nftGallery.appendChild(card);
        });
      } catch(e) {}
    };

    // --- Governance Voting (live proposals & voting) ---
    async function fetchProposals() {
      const res = await fetch("https://api.zyra.network/governance/proposals");
      const proposals = await res.json();
      renderGovernanceVoting(proposals);
    }
    function renderGovernanceVoting(proposals) {
      const panel = document.getElementById('governancePanel');
      panel.innerHTML = '';
      proposals.forEach(p => {
        const div = document.createElement('div');
        div.className = "governance-card";
        div.innerHTML = `
          <div class="gov-title">${p.title}</div>
          <div class="gov-desc">${p.description}</div>
          <div class="gov-actions" style="margin-top:0.7rem;">
            <button onclick="voteProposal('${p.id}','yes')">Vote Yes</button>
            <button onclick="voteProposal('${p.id}','no')">Vote No</button>
          </div>
          <div class="gov-votes">Yes: ${p.votes_yes} | No: ${p.votes_no}</div>
        `;
        panel.appendChild(div);
      });
    }
    async function voteProposal(id, vote) {
      await fetch("https://api.zyra.network/governance/vote", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ proposal_id: id, vote })
      });
      fetchProposals();
    }
    fetchProposals();

    // --- Advanced search logic with real-time suggestions and filters ---
    const searchBtn = document.getElementById('searchBtn');
    const explorerSearch = document.getElementById('explorerSearch');
    const resultsDiv = document.getElementById('results');
    const advancedSearchBtn = document.getElementById('advancedSearchBtn');
    const advancedSearchPanel = document.getElementById('advancedSearchPanel');

    advancedSearchBtn.onclick = () => {
      advancedSearchPanel.style.display = advancedSearchPanel.style.display === "none" ? "block" : "none";
    };

    explorerSearch.addEventListener('input', async () => {
      const q = explorerSearch.value.trim();
      if (q.length > 2) {
        // Simulate suggestion fetch
        resultsDiv.innerHTML = `<div class="result-card">Suggestions: <b>${q}123</b>, <b>${q}abc</b></div>`;
      } else {
        resultsDiv.innerHTML = '';
      }
    });

    searchBtn.addEventListener('click', async () => {
      const query = explorerSearch.value.trim();
      const filters = {
        nfts: document.getElementById('searchNFTs').checked,
        validators: document.getElementById('searchValidators').checked,
        tokens: document.getElementById('searchTokens').checked,
        contracts: document.getElementById('searchContracts').checked
      };
      resultsDiv.innerHTML = '';
      if (!query) {
        resultsDiv.innerHTML = '<div class="result-card">Please enter a search term.</div>';
        return;
      }
      // Simulate results with advanced filters
      let results = [];
      if (filters.nfts) {
        results.push(`<div class="result-card"><div class="result-title">NFT</div><div class="result-details">Name: ${query}NFT<br>Owner: 0xAb12...4Ef8</div></div>`);
      }
      if (filters.validators) {
        results.push(`<div class="result-card"><div class="result-title">Validator</div><div class="result-details">Validator: ${query}Node<br>Status: Online</div></div>`);
      }
      if (filters.tokens) {
        results.push(`<div class="result-card"><div class="result-title">Token</div><div class="result-details">Token: ${query}Token<br>Supply: 1,000,000</div></div>`);
      }
      if (filters.contracts) {
        results.push(`<div class="result-card"><div class="result-title">Smart Contract</div><div class="result-details">Contract: ${query}Contract<br>Status: Verified</div></div>`);
      }
      if (results.length === 0) {
        // Fallback to default logic
        if (query.startsWith('0x9a4f')) {
          results.push(`
            <div class="result-card">
              <div class="result-title">Transaction</div>
              <div class="result-details">
                Hash: <a href="#">${query}</a><br>
                From: <a href="#">0xAb12...4Ef8</a><br>
                To: <a href="#">0xCd34...1A7B</a><br>
                Amount: 12.5 ZYRA<br>
                Status: <span class="status-confirmed">Confirmed</span><br>
                Timestamp: 2025-07-31 15:04:20
              </div>
            </div>
          `);
        } else if (query.startsWith('0xAb12')) {
          results.push(`
            <div class="result-card">
              <div class="result-title">Address</div>
              <div class="result-details">
                Address: <a href="#">${query}</a><br>
                Balance: 1200.5 ZYRA<br>
                Transactions: 3<br>
                Last Active: 2025-07-31 15:06:40
              </div>
            </div>
          `);
        } else if (!isNaN(query)) {
          results.push(`
            <div class="result-card">
              <div class="result-title">Block</div>
              <div class="result-details">
                Block Number: <a href="#">${query}</a><br>
                Transactions: 5<br>
                Miner: Zyra-Node-2<br>
                Timestamp: 2025-07-31 15:05:10
              </div>
            </div>
          `);
        } else {
          results.push(`
            <div class="result-card">
              <div class="result-title">No Results</div>
              <div class="result-details">
                No matching block, transaction, or address found for "<b>${query}</b>".
              </div>
            </div>
          `);
        }
      }
      resultsDiv.innerHTML = results.join('');
    });
    // If you have an exchange logic or UI, restrict it to:
    // - Only allow Zyra → Other crypto
    // - Only allow Other crypto → Zyra
    // (No direct swaps between non-Zyra cryptos)

    // Example for exchange.html (not shown here):
    // - In the "From" dropdown, if Zyra is selected, allow any "To" except Zyra.
    // - If any other crypto is selected as "From", only allow "To" = Zyra.
    // - Disable or hide other combinations.

    // If you have exchange logic in JS, add checks like:
    /*
    function updateExchangeOptions() {
      const from = fromSelect.value;
      const to = toSelect.value;
      // If from is ZYRA, allow any to except ZYRA
      if (from === 'ZYRA') {
        // populate 'to' with all except ZYRA
      } else {
        // Only allow 'to' to be ZYRA
      }
    }
    */
    // --- Live Prices from CoinGecko ---
    async function showLivePrices() {
      const coins = [
        { id: "bitcoin", symbol: "BTC" },
        { id: "ethereum", symbol: "ETH" },
        { id: "solana", symbol: "SOL" },
        { id: "kaspa", symbol: "KAS" },
        { id: "ripple", symbol: "XRP" },
        { id: "zyra", symbol: "ZYRA" } // If Zyra is listed on CoinGecko
      ];
      const ids = coins.map(c => c.id).join(",");
      try {
        const res = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${ids}&vs_currencies=usd`);
        const data = await res.json();
        let html = `<strong>Live Prices (USD):</strong> `;
        coins.forEach(c => {
          if (data[c.id] && data[c.id].usd !== undefined) {
            html += `<span style="margin:0 12px;"><b>${c.symbol}</b>: $${data[c.id].usd.toLocaleString()}</span>`;
          }
        });
        document.getElementById('livePrices').innerHTML = html;
      } catch (e) {
        document.getElementById('livePrices').innerHTML = "Live prices unavailable.";
      }
    }
    showLivePrices();
    setInterval(showLivePrices, 60000); // Update every 60 seconds

    // Initialize charts
    const chartConfig = {
        type: 'line',
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                x: { display: false },
                y: { display: false }
            },
            elements: {
                line: {
                    tension: 0.4,
                    borderColor: '#7eff7e',
                    borderWidth: 2
                },
                point: {
                    radius: 0
                }
            }
        }
    };

    const tpsChart = new Chart(document.getElementById('tpsChart').getContext('2d'), {
        ...chartConfig,
        data: { labels: [], datasets: [{ data: [] }] }
    });

    const nodesChart = new Chart(document.getElementById('nodesChart').getContext('2d'), {
        ...chartConfig,
        data: { labels: [], datasets: [{ data: [] }] }
    });

    const blockTimeChart = new Chart(document.getElementById('blockTimeChart').getContext('2d'), {
        ...chartConfig,
        data: { labels: [], datasets: [{ data: [] }] }
    });

    // WebSocket connection for live stats
            document.getElementById('tpsValue').textContent = data.tps.toFixed(1);
            document.getElementById('nodesValue').textContent = data.nodes;
            document.getElementById('blockTimeValue').textContent = data.blockTime.toFixed(2) + 's';
            document.getElementById('networkLoadValue').textContent = data.networkLoad + '%';
            document.getElementById('networkLoadBar').style.width = data.networkLoad + '%';

            // Update charts
            updateChart(tpsChart, data.tps);
            updateChart(nodesChart, data.nodes);
            updateChart(blockTimeChart, data.blockTime);
        } catch(e) {
            console.error('Error parsing network stats:', e);
        }
    };

    function updateChart(chart, value) {
        const maxDataPoints = 20;
        const labels = [...Array(maxDataPoints)].map((_, i) => i);
        
        chart.data.labels = labels;
        chart.data.datasets[0].data.push(value);
        
        if (chart.data.datasets[0].data.length > maxDataPoints) {
            chart.data.datasets[0].data.shift();
        }
        
        chart.update('none'); // Use 'none' mode for better performance
    }

    // Reconnection logic
    ws.onclose = function() {
        setTimeout(() => {
            window.location.reload();
        }, 5000);
    };

    // --- Live Transactions Feed ---
    const transactionFeed = document.getElementById('transactionFeed');
    const txWs = new WebSocket('wss://api.zyra.network/transactions');

    txWs.onmessage = function(event) {
        try {
            const tx = JSON.parse(event.data);
            const txElement = document.createElement('div');
            txElement.className = 'transaction-item';
            
            txElement.innerHTML = `
                <div class="transaction-hash">
                    ${tx.hash.slice(0, 10)}...${tx.hash.slice(-8)}
                </div>
                <div class="transaction-details">
                    <span>From: ${shortenAddress(tx.from)}</span>
                    <span>→</span>
                    <span>To: ${shortenAddress(tx.to)}</span>
                    <span class="transaction-amount">${formatAmount(tx.amount)} ZYRA</span>
                </div>
                <div class="transaction-time">
                    ${new Date().toLocaleTimeString()}
                </div>
            `;

            transactionFeed.insertBefore(txElement, transactionFeed.firstChild);

            // Keep only last 50 transactions
            if (transactionFeed.children.length > 50) {
                transactionFeed.removeChild(transactionFeed.lastChild);
            }
        } catch(e) {
            console.error('Error parsing transaction:', e);
        }
    };

    function shortenAddress(address) {
        return `${address.slice(0, 6)}...${address.slice(-4)}`;
    }

    function formatAmount(amount) {
        return parseFloat(amount).toFixed(6);
    }

    // Add reconnection logic
    txWs.onclose = function() {
        setTimeout(() => {
            location.reload();
        }, 5000);
    };
  </script>
</body>
</html>
