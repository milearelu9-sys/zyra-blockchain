<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zyra Blockchain Governance</title>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0047ab 0%, #001f4d 100%);
      color: #d0e8ff;
      margin: 0;
      min-height: 100vh;
    }
    header {
      padding: 1rem 3rem;
      background: rgba(0, 71, 171, 0.9);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      font-weight: 700;
      font-size: 1.6rem;
      color: #a8d0ff;
      letter-spacing: 0.15em;
      text-transform: uppercase;
    }
    nav {
      display: flex;
      gap: 2rem;
    }
    nav a {
      font-weight: 600;
      font-size: 1rem;
      color: #a8d0ff;
      text-decoration: none;
      padding: 0.3rem 0.5rem;
      border-radius: 4px;
      transition: background-color 0.3s ease;
    }
    nav a:hover {
      background-color: #3385ffcc;
      color: #001f4d;
    }
    main {
      max-width: 900px;
      margin: 2rem auto;
      background: rgba(30, 60, 130, 0.7);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 0 20px #3399ffbb;
    }
    h1 {
      color: #a8d0ff;
      font-size: 2.2rem;
      margin-bottom: 1.5rem;
      text-align: center;
      font-weight: 700;
      letter-spacing: 0.1em;
    }
    .proposal-list {
      margin-bottom: 2rem;
    }
    .proposal-card {
      background: rgba(50, 100, 255, 0.15);
      border-radius: 10px;
      padding: 1.5rem 1.8rem;
      box-shadow: 0 2px 8px #3385ff44;
      color: #cce4ff;
      margin-bottom: 1.2rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      transition: box-shadow 0.3s ease;
      cursor: default;
    }
    .proposal-card:hover {
      box-shadow: 0 0 25px #66b2ffcc;
    }
    .proposal-card h3 {
      margin: 0 0 0.5rem 0;
      font-weight: 700;
      font-size: 1.3rem;
      color: #66b2ff;
    }
    .proposal-card .details {
      font-size: 0.98rem;
      color: #a0c4ffbb;
      margin-bottom: 0.7rem;
    }
    .proposal-card .status {
      font-weight: 600;
      color: #7eff7e;
      margin-bottom: 0.7rem;
    }
    .proposal-card .status.closed {
      color: #ff7e7e;
    }
    .proposal-card .status.active {
      color: #ffb366;
    }
    .proposal-card button {
      background: #1e3c82;
      color: #a8d0ff;
      border: 1.5px solid #3385ff;
      border-radius: 8px;
      padding: 0.6rem 1.2rem;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
      margin-top: 0.5rem;
    }
    .proposal-card button:hover {
      background-color: #3385ff;
      color: #001f4d;
    }
    .vote-count {
      margin-top: 0.5rem;
      font-size: 1rem;
      color: #e0f0ff;
    }
    footer {
      text-align: center;
      padding: 1rem 0;
      font-weight: 500;
      font-size: 0.9rem;
      color: #a0c4ffbb;
      background: rgba(0, 31, 77, 0.8);
      letter-spacing: 0.08em;
      margin-top: 2rem;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">ZYRA</div>
    <nav>
      <a href="index.html">Dashboard</a>
      <a href="explorer.html">Explorer</a>
      <a href="validators.html">Validators</a>
      <a href="governance.html">Governance</a>
      <a href="launchpad.html">Launchpad</a>
      <a href="nfts.html">NFTs</a>
      <a href="docs.html">Docs</a>
    </nav>
  </header>
  <main>
    <h1>Zyra Blockchain Governance</h1>
    <div class="proposal-list" id="proposalList">
      <!-- Proposals will be rendered here -->
    </div>
    <div class="create-proposal-panel" id="createProposalPanel" style="margin-top:2rem;background:rgba(50,100,255,0.10);border-radius:12px;padding:1.5rem;">
      <h2 style="color:#a8d0ff;margin-bottom:1rem;">Create New Proposal</h2>
      <input id="newTitle" type="text" placeholder="Proposal Title" style="width:100%;margin-bottom:0.7rem;padding:0.5rem;border-radius:6px;border:none;" />
      <textarea id="newDetails" placeholder="Proposal Details" style="width:100%;margin-bottom:0.7rem;padding:0.5rem;border-radius:6px;border:none;"></textarea>
      <input id="newEndDate" type="date" style="margin-bottom:0.7rem;padding:0.5rem;border-radius:6px;border:none;" />
      <button id="submitProposalBtn" style="background:#3385ff;color:#fff;border:none;border-radius:8px;padding:0.7rem 1.5rem;font-weight:600;font-size:1rem;cursor:pointer;">Submit Proposal</button>
      <div id="proposalStatus" style="margin-top:0.7rem;color:#7eff7e;"></div>
    </div>
    <div class="analytics-section" style="margin-top:2rem;">
      <h2 style="text-align:center;color:#a8d0ff;">Governance Analytics</h2>
      <canvas id="governanceChart" height="120"></canvas>
    </div>
  </main>
  <footer>
    Â© 2025 Zyra Blockchain. All rights reserved.
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Example governance proposals (can be loaded from backend)
    let proposals = [
      {
        id: 1,
        title: "Increase Block Size",
        details: "Proposal to increase the block size from 2MB to 4MB for higher throughput.",
        status: "active",
        ends: "2025-08-20",
        votesFor: 120,
        votesAgainst: 45,
        voters: []
      },
      {
        id: 2,
        title: "Reduce Validator Commission",
        details: "Proposal to reduce the maximum validator commission from 10% to 7%.",
        status: "closed",
        ended: "2025-07-30",
        votesFor: 210,
        votesAgainst: 30,
        voters: []
      },
      {
        id: 3,
        title: "Add NFT Marketplace",
        details: "Proposal to integrate a decentralized NFT marketplace into Zyra.",
        status: "active",
        ends: "2025-08-25",
        votesFor: 95,
        votesAgainst: 12,
        voters: []
      }
    ];

    // Advanced: Track user votes and prevent double voting
    let userAddress = localStorage.getItem("zyra_user") || ("0x" + Math.random().toString(16).slice(2, 10) + Math.random().toString(16).slice(2, 10));
    localStorage.setItem("zyra_user", userAddress);

    function renderGovernance() {
      const list = document.getElementById('proposalList');
      list.innerHTML = '';
      proposals.forEach(proposal => {
        const card = document.createElement('div');
        card.className = 'proposal-card';
        const hasVoted = proposal.voters.includes(userAddress);
        card.innerHTML = `
          <h3>${proposal.title}</h3>
          <div class="details">${proposal.details}</div>
          <div class="status ${proposal.status}">
            ${proposal.status === "active" ? "Active" : "Closed"}
          </div>
          <div class="details">
            ${proposal.status === "active" ? `Ends: ${proposal.ends}` : `Ended: ${proposal.ended}`}
          </div>
          <div class="vote-count">
            Votes For: ${proposal.votesFor} &nbsp;|&nbsp; Votes Against: ${proposal.votesAgainst}
          </div>
          ${proposal.status === "active" ? `
            <button ${hasVoted ? "disabled" : ""} onclick="voteProposal(${proposal.id}, true)">
              Vote For
            </button>
            <button ${hasVoted ? "disabled" : ""} onclick="voteProposal(${proposal.id}, false)">
              Vote Against
            </button>
            ${hasVoted ? `<div style="color:#ffb366;margin-top:0.5rem;">You have voted</div>` : ""}
          ` : ""}
        `;
        list.appendChild(card);
      });
    }

    window.voteProposal = function(id, isFor) {
      const proposal = proposals.find(p => p.id === id);
      if (!proposal || proposal.voters.includes(userAddress)) return;
      if (isFor) proposal.votesFor++;
      else proposal.votesAgainst++;
      proposal.voters.push(userAddress);
      renderGovernance();
      updateGovernanceChart();
    };

    // Advanced: Create new proposal
    document.getElementById('submitProposalBtn').onclick = function() {
      const title = document.getElementById('newTitle').value.trim();
      const details = document.getElementById('newDetails').value.trim();
      const ends = document.getElementById('newEndDate').value;
      const statusDiv = document.getElementById('proposalStatus');
      if (!title || !details || !ends) {
        statusDiv.textContent = "All fields are required.";
        statusDiv.style.color = "#ff7e7e";
        return;
      }
      proposals.push({
        id: proposals.length + 1,
        title,
        details,
        status: "active",
        ends,
        votesFor: 0,
        votesAgainst: 0,
        voters: []
      });
      statusDiv.textContent = "Proposal submitted!";
      statusDiv.style.color = "#7eff7e";
      renderGovernance();
      updateGovernanceChart();
      document.getElementById('newTitle').value = "";
      document.getElementById('newDetails').value = "";
      document.getElementById('newEndDate').value = "";
      setTimeout(() => statusDiv.textContent = "", 2000);
    };

    // Advanced: Governance analytics chart
    const ctx = document.getElementById('governanceChart').getContext('2d');
    const governanceChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: proposals.map(p => p.title),
        datasets: [
          {
            label: 'Votes For',
            data: proposals.map(p => p.votesFor),
            backgroundColor: '#7eff7e'
          },
          {
            label: 'Votes Against',
            data: proposals.map(p => p.votesAgainst),
            backgroundColor: '#ff7e7e'
          }
        ]
      },
      options: {
        responsive: true,
        plugins: { legend: { display: true } },
        scales: { y: { beginAtZero: true } }
      }
    });

    function updateGovernanceChart() {
      governanceChart.data.labels = proposals.map(p => p.title);
      governanceChart.data.datasets[0].data = proposals.map(p => p.votesFor);
      governanceChart.data.datasets[1].data = proposals.map(p => p.votesAgainst);
      governanceChart.update();
    }

    renderGovernance();
    updateGovernanceChart();
  </script>
</body>
</html>
